---
layout: post
title: "[Basic] XSD"
subtitle: 엑쎄쓰디
author: Bonazoey
categories: Basic
banner:
  image: "./assets/images/basic.gif"
  height: "100vh"
  min_height: "38vh"
  heading_style: "font-size: 4.25em; font-weight: bold"
  subheading_style: "color: gold"
tags: [Basic, XML]
date: 2024-04-08 09:00:00 +0900
top: false
---

## XSD

XML 스키마 정의(XSD)란 **XML 파일에 몇 개의 element, attribute가 있는지, 몇 개의 child element를 갖는지, data type은 무엇인지, default나 fixed value로 설정할 게 있는지에 대한 정보를 가지고 있는 파일**이다.

이것은 Well-formed xml이 vailed xml이 되기위한 갖춰야할 조건 중 하나이다. 나머지는 DTD가 있다.

DTD와 달리 XML 문법으로 이루어져 따로 공부를 할 부담이 적고 확장성이 좋고 DTD의 단점들을 보완시킨 검증이다.

## 문법

아래는 XSD의 예제이다.

~~~xml
<?xml version="1.0" encoding="UTF-8" ?>
<!-- 1 -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
<!-- 2 -->
  targetNamespace="http://codingsam.com"
<!-- 3 -->
  xmlns="http://codingsam.com"
<!-- 4 -->
  elementFormDefault="qualified">

<xs:element name="food">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="name" type="xs:string"/>
      <xs:element name="type" type="xs:string"/>
      <xs:element name="cost" type="xs:string"/>
    </xs:sequence>
  </xs:complexType>
</xs:element>

</xs:schema>
~~~

위의 예제가 XML을 XSD로 표현한 것이다. XSD의 루트 요소는 `<schema>` 요소이다.

여기서 식별자에 꼭 URI를 넣지 않고, URL이나 URN을 넣어도 된다. 그 외에 문자열을 넣어도 작동은 되지만 유일성 확보가 떨어지기 때문에 보통 URI를 사용한다.

그렇다고 해당 URI 사이트 내의 어떤 기능을 사용하는 것은 아니고, 그냥 진짜 구분을 위한 것이다.

<schema>를 이용한 XML 스키마 선언은 다음과 같은 문법을 따른다.

| 번호 | 속성 | 설명 | 풀이 |
| :---: | :---: | :--- | :--- |
| 1 | xmlns:xs | XML 스키마에 사용할 W3C의 XML 스키마 네임스페이스 명시 | 식별자에 넣은 URI 주소에서 정의한 기능들을 사용할 수 있다 |
| 2 | targetNamespace | 스키마에 정의한 요소나 속성들을 다른 XML 문서에서 식별할 수 있게 네임스페이스 지정 | 해당 엘리먼트들은 이 식별자에 의해 종속되며 다른 XML 문서에서 사용할 때 충돌하지 않게 방지해준다 |
| 3 | xmlns | 예약되어 있는 키워드로 네임스페이스 정의 | 다른 XML 문서에서 사용 시 사용할 네임스페이스를 가져온다. 또 여기서는 다른 문서가 아니므로 targetNamespace로 인해 생략해도 가능하나, 기본적으로 명시해주는 것이 원칙이다. |
| 4 | elementFormDefault | 해당 스키마를 이용해 선언한 XML 문서의 모든 요소가 네임스페이스를 만족한 다는 것 명시 | 따라서 사용하는 XML 에서는 접두사 네임스페이스를 사용할 필요가 없다. 하지만 unqualified 시 접두사를 명시하지 않으면 해당 스키마 요소의 기능을 사용하지 않음 |

## 1. 단순 타입(Simple Type) 요소

### 1-1. 단순 타입 요소 선언

기본 자료형 요소를 선언하는 문법은 다음과 같다.

~~~xml
<xs:element name="요소이름" type="요소타입"/>
~~~

XSD에서 제공하는 다양한 기본 타입과 파생된 타입을 사용할 수 있다.

아래는 xml 엘리먼트의 XSD의 타입 요소 선언 예제이다.

~~~xml
<name>홍길동</name>
<age>20</age>
<birthtime>15:30:00</birthtime>
~~~
~~~xml
<xs:element name="name" type="xs:string"/> <!-- 문자열 타입 -->
<xs:element name="age" type="xs:integer"/> <!-- 정수 타입 -->
<xs:element name="birthtime" type="xs:time"/> <!-- 시간 타입 -->
~~~

### 1-2. 타입 요소의 기본값 선언

타입 요소의 default 속성을 이용하여 기본값을 명시할 수 있다.

~~~xml
<xs:element name="grade" type="xs:string" default="B"/>
~~~

위 처럼 설정하면 요소에 아무 값도 명시되지 않을 시 기본으로 'B'가 들어간다.

### 1-3. 타입 요소의 고정값 선언

타입 요소의 fixed 속성을 이용하여 고정값을 명시할 수 있다.

~~~xml
<xs:element name="grade" type="xs:string" fixed="D"/>
~~~

위 처럼 설정하면 요소에 어떤 값이 명시돼도 무조 'D'가 들어간다.

### 1-4. XSD의 속성

XSD의 단순 타입 요소는 속성을 가질 수 없다. 만약 속성을 갖게 된다면 그 요소는 복합 타입이 된다.

하지만 속성 자체는 언제나 단순 타입으로 선언된다.

종류는 복합 타입요소지만 선언은 단순 타입으로 선언되기 때문에 단순 타입 요소 항목으로 분류류하였다.

~~~xml
xs:attribute name="속성명" tyep="속성타입"/>
~~~


#### 1-4-1. 속성의 필수값 선언언

속성의 기본값과 고정값 선언은 타입요소의 선언과 같으며 추가로 필수 속성을 선언할 수 있다.

~~~xml
<xs:attribute name="division" type="xs:string" use="required"/>
~~~

필수 속성은 use 뒤에 속성값 required로 설정하면 요소 선언시 반드시 같이 선어되어야 한다.

반대로 속성값이 prohibited로 설정되면 해당 속성이 존재하지 않아아 유효한 XML 문서로 간주된다.

### 1-5. XSD의 제한(facets)

XSD에서는 XML 요소나 속성 선언 시 그 값에 대한 범위를 제한할 수 있다.

단순 타입 요소의 값의 범위를 제한하기 위해 <restriction> 요소를 사용하고 base 속성은 제한 사항을 적용할 타입을 명시한다.

~~~xml
<restriction base="타입">
  타입에 대한 제한 사항
</restriction>
~~~

#### 1-5-1. 범위 제한

| 제한 | 특징 |
| :---: | :---|
| maxExclusive | 특정 범위 전까지의 상한값 명시 |
| maxInclusive | 특정 범위 까지의 상한값 명시 |
| minExclusive | 특정 범위 전까지의 하한값 명시 |
| minInclusive | 특정 범위 까지의 하한값 명시 |

아래는 예제이다.

~~~xml
<xs:element name="allowance">
  <xs:simpleType>
    <!-- restriction 선언 -->
    <xs:restriction base="xs:integer">
      <!-- 범위값 선언 -->
      <xs:minInclusive value="0"/>
      <xs:maxInclusive value="100000"/>
    </xs:restriction>
  </xs:simpleType>
</xs:element>
~~~

#### 1-5-2. 선택 제한

단순 타입 요소의 값을 특정 값 중에 선택하도록 제한하고자 할 때 `<enumeration>`을 사용한다.

이 곳 value 속성 값에 허용 값들의 리스트를 나열한다.

~~~xml
<xs:element name="unit">
  <xs:simpleType>
    <xs:restriction base="xs:string">
      <xs:enumeration value="원"/>
      <xs:enumeration value="달러"/>
      <xs:enumeration value="엔"/>
    </xs:restriction>
  </xs:simpleType>
</xs:element>
~~~

여기서 `<unit>` 요소는 `원, 달러, 엔` 중 하나만 대입할 수 있다.

#### 1-5-3. 패턴 제한

단순 타입 요소의 텍스트가 특정 패턴을 보이도록 하려면 `<pattern>`을 사용한다.

이 곳 value 속성 값엔 허용되는 정규식이 들어간다.

~~~xml
<xs:element name="camel">
  <xs:simpleType>
    <xs:restriction base="xs:string">
      <xs:pattern value="([A-Z][a-z])+"/>
    </xs:restriction>
  </xs:simpleType>
</xs:element>
~~~

여기서 `<camel>` 요소에는 `대문자 + 소문자로 이루어진 한쌍 이상의 텍스트`만 대입 가능하다.

#### 1-5-4. 공백 제한

`<whiteSpace>`를 사용하면 공백을 어떻게 다룰지 명시할 수 있다.

value 값엔 다음과 같은 값들이 들어갈 수 있다.

| 속성값 | 기능 |
| :---: | :--- |
| preserve | 어떠한 공백도 제거하지 않는다. |
| replace | 모든 종류의 공백(line feeds, carriage returns, tabs, spaces)을 띄어쓰기로 모두 대체한다. |
| collapse | 모든 종류의 공백은 띄어쓰기로 모두 대체되고, 문자열 앞뒤의 여백도 제거되며, 많은 수의 띄어쓰기는 하나의 띄어쓰기로 변환된다. |

아래는 예제이다.

~~~xml

<xs:element name="white">
  <xs:simpleType>
    <xs:restriction base="xs:string">
      <xs:whiteSpace value="replace"/>
    </xs:restriction>
  </xs:simpleType>
</xs:element>
~~~

여기서 `<white>` 요소에 포함된 모든 공백은 띄어쓰기로 대체된다.

#### 1-5-5. 그 외

그 외에도 다양한 제한이 있다.

| 제한 | 설명 |
| :---: | :--- |
| length | 허용되는 문자열의 길이나 리스트 요소의 수를 명시함. (반드시 0과 같거나 0보다는 커야 함) |
| maxLength |	허용되는 문자열의 최대 길이나 리스트 요소의 최댓값을 명시함. (반드시 0과 같거나 0보다는 커야 함) |
| minLength	| 허용되는 문자열의 최소 길이나 리스트 요소의 최솟값을 명시함. (반드시 0과 같거나 0보다는 커야 함) |
| maxExclusive | 허용치의 상한값을 명시함. (모든 값은 반드시 이 값보다 작아야 함) |
| maxInclusive | 허용치의 상한값을 명시함. (모든 값은 반드시 이 값과 같거나 이 값보다 작아야 함) |
| minExclusive | 허용치의 하한값을 명시함. (모든 값은 반드시 이 값보다 커야 함) |
| minInclusive | 허용치의 하한값을 명시함. (모든 값은 반드시 이 값과 같거나 이 값보다 커야 함) |
| enumeration	| 허용되는 값의 리스트를 정의함. |
| pattern	| 텍스트 데이터의 형식을 정규 표현식을 이용하여 정의함. |
| whiteSpace | 공백이 어떻게 다루어질지를 명시함. (line feeds, carriage returns, tabs, spaces) |
| fractionDigits | 허용되는 소수부의 자릿수를 명시함. (반드시 0과 같거나 0보다는 커야 함) |
| totalDigits | 허용되는 자릿수를 명시함. (반드시 0보다는 커야 함) |

### 2. 복합 타입(Complex Type) 요소

복합 타입 요소는 자식 요소나 속성을 포함하는 요소를 의미한다.
